RepeatSelf[n] := Repeat[n, n]

Kolakoski[seed] := @Curry[[state, seed, n] -> {
    While[#state.cache <= n,
        While[#state.cache <= state.i,
            Push[state.cache, ...RepeatSelf[seed[state.i % #seed]]];;
                state["i"] @= state.i + 1
        ];;
        Push[state.cache, ...Repeat[seed[state.i % #seed], state.cache@state.i]];;
        state["i"] @= state.i + 1
    ]
    state.cache@n
}][ <~ cache -> RepeatSelf[seed@0], i -> 1 ~>, seed ]

A2 := A000002 := Kolakoski[1'2]
